<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Dubbo"><meta name="keywords" content="Dubbo"><meta name="author" content="Jiayi Yang"><meta name="copyright" content="Jiayi Yang"><title>Dubbo | Blog of JiayiY</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-number">1.</span> <span class="toc-text">各种知识点总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">常见面试题</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.bmp.ovh/imgs/2021/06/648ee42f65e461cd.jpg"></div><div class="author-info__name text-center">Jiayi Yang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">55</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">18</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">4</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.bmp.ovh/imgs/2021/06/b914bf63a6c6a1d2.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Blog of JiayiY</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">Dubbo</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-06-21</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>Dubbo相关的知识及常见问题：）</p>
<a id="more"></a>

<h1 id="各种知识点总结"><a href="#各种知识点总结" class="headerlink" title="各种知识点总结"></a>各种知识点总结</h1><h2 id="常见面试题"><a href="#常见面试题" class="headerlink" title="常见面试题"></a>常见面试题</h2><ol>
<li><p>什么是Dubbo？</p>
<p>是一个分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案，以及SOA服务治理方案。</p>
<blockquote>
<p>面向服务的架构（SOA）是一个组件模型，它将应用程序的不同功能单元（称为服务）进行拆分，并通过这些服务之间定义良好的接口和协议联系起来。接口是采用中立的方式进行定义的，它应该独立于实现服务的硬件平台、操作系统和编程语言。这使得构件在各种各样的系统中的服务可以以一种统一和通用的方式进行交互。</p>
</blockquote>
</li>
<li><p>什么是RPC？</p>
<p><img src="/2020/06/21/Dubbo/2.jpg" alt="RPC工作时序图"></p>
<p>Remote Procedure Call 是一种远程调用，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。</p>
<p>例如，A，B服务分别部署在两台不同的机器上，如何解决服务A调用服务B中的某个方法的问题，HTTP请求较慢，RPC应运而生。</p>
</li>
<li><p>为什么使用Dubbo？</p>
<ul>
<li><p>负载均衡：同一个服务部署在不同的机器时该调用那一台机器上的服务；</p>
</li>
<li><p>服务调用链路生成：随着系统的发展，服务越来越多，服务间依赖关系变得错踪复杂，Dubbo可以解决服务之间互相是如何调用的；</p>
</li>
<li><p>服务访问压力以及时长统计、资源调度和治理：基于访问压力实时管理集群容量，提高集群利用率；</p>
</li>
<li><p>服务降级：某个服务挂掉之后调用备用服务；</p>
</li>
</ul>
</li>
<li><p>Dubbo的架构</p>
<p><img src="/2020/06/21/Dubbo/3.jpg" alt="Dubbo架构"></p>
<p>Provider：暴露服务的服务提供方；</p>
<p>Consumer：调用远程服务的服务消费方；</p>
<p>Registry：服务注册与发现的注册中心；</p>
<p>Monitor：统计服务的调用次数和调用时间的监控中心；</p>
<p>Container：服务运行容器；</p>
<ul>
<li><p>调用关系</p>
<p>服务容器负责启动，加载，运行服务提供者；</p>
<p>服务提供者在启动时，向注册中心注册自己提供的服务；</p>
<p>服务消费者在启动时，向注册中心订阅自己所需的服务；</p>
<p>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者；</p>
<p>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用；</p>
<p>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心；</p>
</li>
</ul>
<p>重要知识点总结：</p>
<p>注册中心负责服务地址的注册与查找，相当于目录服务，服务提供者和消费者只在启动时与注册中心交互，注册中心不转发请求，压力较小；</p>
<p>监控中心负责统计各服务调用次数，调用时间等，统计先在内存汇总后每分钟一次发送到监控中心服务器，并以报表展示；</p>
<p>注册中心，服务提供者，服务消费者三者之间均为长连接，监控中心除外；</p>
<p>注册中心通过长连接感知服务提供者的存在，服务提供者宕机，注册中心将立即推送事件通知消费者；</p>
<p>注册中心和监控中心全部宕机，不影响已运行的提供者和消费者，消费者在本地缓存了提供者列表；</p>
<p>注册中心和监控中心都是可选的，服务消费者可以直连服务提供者；</p>
<p>服务提供者无状态，任意一台宕掉后，不影响使用；</p>
<p>服务提供者全部宕掉后，服务消费者应用将无法使用，并无限次重连等待服务提供者恢复；</p>
</li>
<li><p>Dubbo工作原理</p>
<p>图中从下至上分为十层，各层均为单向依赖，右边的黑色箭头代表层之间的依赖关系，每一层都可以剥离上层被复用，其中，Service 和 Config 层为 API，其它各层均为 SPI。</p>
<p>各层说明：</p>
<ul>
<li>第一层：<strong>service层</strong>，接口层，给服务提供者和消费者来实现的；</li>
<li>第二层：<strong>config层</strong>，配置层，主要是对dubbo进行各种配置的；</li>
<li>第三层：<strong>proxy层</strong>，服务接口透明代理，生成服务的客户端 Stub 和服务器端 Skeleton；</li>
<li>第四层：<strong>registry层</strong>，服务注册层，负责服务的注册与发现；</li>
<li>第五层：<strong>cluster层</strong>，集群层，封装多个服务提供者的路由以及负载均衡，将多个实例组合成一个服务；</li>
<li>第六层：<strong>monitor层</strong>，监控层，对rpc接口的调用次数和调用时间进行监控；</li>
<li>第七层：<strong>protocol层</strong>，远程调用层，封装rpc调用；</li>
<li>第八层：<strong>exchange层</strong>，信息交换层，封装请求响应模式，同步转异步；</li>
<li>第九层：<strong>transport层</strong>，网络传输层，抽象mina和netty为统一接口；</li>
<li>第十层：<strong>serialize层</strong>，数据序列化层。网络传输需要；</li>
</ul>
</li>
<li><p>Dubbo中的负载均衡算法及其特点</p>
<p>1）RandomLoadBalance：随机负载均衡，是Dubbo的默认负载均衡策略。</p>
<p>按照权重分配随机概率，在Dubbo中可以对 Provider设置权重。比如机器性能好的，可以设置大一点的权重，性能差的，可以设置小一点的权重。如果没有在Dubbo Admin中对服务 Provider 设置权重，那么所有的 Invoker 的权重就是一样的，默认是100。</p>
<p>2）RoundRobinLoadBalance：轮询负载均衡，依次的调用所有的Provider。</p>
<p>和随机负载均衡策略一样，轮询负载均衡策略也有权重的概念。轮询负载均衡算法可以让RPC调用严格按照我们设置的比例来分配。但是轮询负载均衡算法也有不足的地方，存在慢的Provider累积请求的问题，比如：第二台机器很慢，但没挂，当请求调到第二台时就卡在那，久而久之，所有请求都卡在调到第二台上，导致整个系统变慢。</p>
<p>3）LeastActiveLoadBalance：最少活跃调用数，相同活跃数的随机。活跃数指调用前后计数差。使慢的 Provider 收到更少请求，因为越慢的 Provider 的调用前后计数差会越大。</p>
<p>比如：每个服务维护一个活跃数计数器。当A机器开始处理请求，该计数器加1，此时A还未处理完成。若处理完毕则计数器减1。而B机器接受到请求后很快处理完毕。那么A,B的活跃数分别是1，0。当又产生了一个新的请求，则选择B机器去执行(B活跃数最小)，这样使慢的机器A收到少的请求。<br>4）ConsistentHashLoadBalance：一致性Hash算法。相同参数的请求总是落在同一Provider。当某一台 Provider 崩溃时，原本发往该 Provider 的请求，基于虚拟节点，平摊到其它 Provider，不会引起剧烈变动。</p>
<p>一致性Hash算法可以和缓存机制配合起来使用。比如有一个服务getUserInfo(String userId)。设置了Hash算法后，相同的userId的调用，都会发送到同一个 Provider。这个 Provider 上可以把用户数据在内存中进行缓存，减少访问数据库或分布式缓存的次数。如果业务上允许这部分数据有一段时间的不一致，可以考虑这种做法。减少对数据库，缓存等中间件的依赖和访问次数，同时减少了网络IO操作，提高系统性能。</p>
<blockquote>
<p>和Dubbo其他的配置类似，多个配置是有覆盖关系的：</p>
<p>方法级优先，接口级次之，全局配置再次之；</p>
<p>如果级别一样，则消费方优先，提供方次之；</p>
</blockquote>
</li>
<li><p>dubbo中的URL</p>
<p>protocol://username:password@host:port/path?key=value&amp;key=value</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">dubbo:&#x2F;&#x2F;192.168.1.6:20880&#x2F;moe.cnkirito.sample.HelloService?timeout&#x3D;3000</span><br><span class="line">描述一个 dubbo 协议的服务</span><br><span class="line"></span><br><span class="line">zookeeper:&#x2F;&#x2F;127.0.0.1:2181&#x2F;org.apache.dubbo.registry.RegistryService?application&#x3D;demo-consumer&amp;dubbo&#x3D;2.0.2&amp;interface&#x3D;org.apache.dubbo.registry.RegistryService&amp;pid&#x3D;1214&amp;qos.port&#x3D;33333&amp;timestamp&#x3D;1545721981946</span><br><span class="line">描述一个 zookeeper 注册中心</span><br><span class="line"></span><br><span class="line">consumer:&#x2F;&#x2F;30.5.120.217&#x2F;org.apache.dubbo.demo.DemoService?application&#x3D;demo-consumer&amp;category&#x3D;consumers&amp;check&#x3D;false&amp;dubbo&#x3D;2.0.2&amp;interface&#x3D;org.apache.dubbo.demo.DemoService&amp;methods&#x3D;sayHello&amp;pid&#x3D;1209&amp;qos.port&#x3D;33333&amp;side&#x3D;consumer&amp;timestamp&#x3D;1545721827784</span><br><span class="line">描述一个消费者</span><br></pre></td></tr></table></figure>

<ul>
<li>protocol：一般是 dubbo 中的各种协议 如：dubbo、thrift、http、zk</li>
<li>username/password：用户名/密码</li>
<li>host/port：主机IP地址/端口号</li>
<li>path：接口名称</li>
<li>parameter：参数键值对</li>
</ul>
</li>
<li><p>dubbo 服务暴露</p>
<p>Spring IOC容器刷新完毕</p>
<p>ServiceBean#OnApplicationEvent</p>
<p>ServiceConfig#export</p>
<p>（如果需要延迟就延迟，不需要就直接用）</p>
<p>ServiceConfig#doExport</p>
<p>（获取注册中心URL，循环调用）</p>
<p>ServiceConfig#doExportUrls</p>
<p>ServiceConfig#doExportUrlsFor1Protocol</p>
</li>
</ol>
<p>1、dubbo中”读接口”和”写接口”有什么区别?</p>
<p>3、最小活跃数算法中是如何统计这个活跃数的？</p>
<p>5、服务发布过程中做了哪些事？</p>
<p>6、dubbo都有哪些协议,他们之间有什么特点,缺省值是什么？</p>
<p>7、什么是本地暴露和远程暴露,他们的区别？</p>
<p>8、服务提供者能实现失效踢出是根据什么原理?</p>
<p>9、讲讲dubbo服务暴露中本地暴露,并画图辅助说明？</p>
<p>10、一般选择什么注册中心,还有别的选择吗?</p>
<p>11、dubbo中zookeeper做注册中心,如果注册中心集群都挂掉,那发布者和订阅者还能通信吗?(面试高频题)</p>
<p>12、项目中有使用过多线程吗?有的话讲讲你在哪里用到了多线程?(面试高频题)</p>
<p>13、zookeeper的java客户端你使用过哪些?</p>
<p>14、服务提供者能实现失效踢出是什么原理？(高频题)</p>
<p>15、zookeeper的有哪些节点,他们有什么区别?讲一下应用场景。</p>
<p>17、在dubbo中,什么时候更新本地的zookeeper信息缓存文件?订阅zookeeper信息的整体过程是怎么样的?</p>
<p>18、谈一下你们项目架构设计(很多人在回答这个的时候都容易回答SSH或者SSM,注意,所谓是SSH这些是技术选型,不是架构的设计)</p>
<p>19、既然你们项目用到了dubbo,那你讲讲你们是怎么通过dubbo实现服务降级的,降级的方式有哪些,又有什么区别?</p>
<p>20、dubbo监控平台能够动态改变接口的一些设置,其原理是怎样的?</p>
<p>21、既然你说你看过dubbo源码,那讲一下有没有遇到过什么坑?(区分度高,也是检验是否看过源码的试金石)</p>
<p>23、有没有考虑过自己实现一个类似dubbo的RPC框架,如果有,请问你会如果着手实现?(面试高频题,区分度高)</p>
<p>24、你说你用过mybatis,那你知道Mapper接口的原理吗?(如果回答得不错,并且提到动态代理这个关键词会继续往下问,那这个动态代理又是如何通过依赖注入到Mapper接口的呢?)</p>
<p>26、既然你提到了dubbo的服务引用中封装通信细节是用到了动态代理,那请问创建动态代理常用的方式有哪些,他们又有什么区别?dubbo中用的是哪一种?(高频题)</p>
<p>27、除了JDK动态代理和CGLIB动态代理外,还知不知道其他实现代理的方式?(区分度高)</p>
<p>28、你是否了解spi,讲一讲什么是spi,为什么要使用spi?</p>
<p>29、对类加载机制了解吗,说一下什么是双亲委托模式,他有什么弊端,这个弊端有没有什么我们熟悉的案例,解决这个弊端的原理又是怎么样的?</p>
<p>30、既然你对spi有一定了解,那么dubbo的spi和jdk的spi有区别吗?有的话,究竟有什么区别?</p>
<p>31、你提到了dubbo中spi也增加了IoC,那你先讲讲Spring的IoC,然后再讲讲dubbo里面又是怎么做的？</p>
<p>32、你提到了dubbo中spi也增加了AOP,那你讲讲这用到了什么设计模式,dubbo又是如何做的？</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Jiayi Yang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://jiayiy.github.io/2020/06/21/Dubbo/">https://jiayiy.github.io/2020/06/21/Dubbo/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Dubbo/">Dubbo</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/06/22/Lcof18/"><i class="fa fa-chevron-left">  </i><span>Lcof18</span></a></div><div class="next-post pull-right"><a href="/2020/06/19/Lcof15/"><span>Lcof15</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.bmp.ovh/imgs/2021/06/b914bf63a6c6a1d2.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By Jiayi Yang</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script src="/js/search/local-search.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.3" zIndex="-2" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>